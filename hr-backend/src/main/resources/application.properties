# ============================================
# ==== Spring Boot HR Backend Configuration ===
# ============================================

# ---- App basics ----
spring.application.name=hr-backend
server.port=${SERVER_PORT:8080}

# ---- Datasource ----
spring.datasource.url=${DB_URL:jdbc:mysql://localhost:3306/hrdb?useSSL=false&allowPublicKeyRetrieval=true&serverTimezone=UTC}
spring.datasource.username=${DB_USER:hr}
spring.datasource.password=${DB_PASS:hrpw}
spring.datasource.driver-class-name=com.mysql.cj.jdbc.Driver

# ---- JPA & Hibernate ----
spring.jpa.hibernate.ddl-auto=none         # Let Flyway manage schema
spring.jpa.generate-ddl=false
spring.jpa.open-in-view=false
spring.jpa.properties.hibernate.jdbc.time_zone=UTC
spring.jpa.show-sql=false

# ---- Flyway (Database Migration) ----
spring.flyway.enabled=true
spring.flyway.locations=classpath:db/migration
spring.flyway.clean-disabled=true
spring.flyway.baseline-on-migrate=true
spring.flyway.table=flyway_schema_history
spring.flyway.validate-on-migrate=true
spring.flyway.out-of-order=false

# ---- Actuator / Observability ----
management.endpoints.web.exposure.include=health,info,prometheus
management.endpoint.prometheus.enabled=true
management.endpoint.health.show-details=always
management.metrics.tags.application=${spring.application.name}
management.server.port=${MANAGEMENT_PORT:${server.port}}
management.endpoints.web.base-path=/actuator

# ---- Micrometer (Prometheus Metrics Registry) ----
# (Enable automatic binding for system, JVM, datasource metrics)
management.metrics.enable.jvm=true
management.metrics.enable.system=true
management.metrics.enable.tomcat=true

# ---- Logging ----
logging.level.root=INFO
logging.level.org.springframework.web=INFO
logging.level.org.hibernate.SQL=INFO
logging.level.org.flywaydb.core=INFO

# ---- CORS (for local dev or Docker frontend) ----
spring.web.cors.allowed-origins=http://localhost:4200,http://localhost:8083
spring.web.cors.allowed-methods=GET,POST,PUT,DELETE,OPTIONS
spring.web.cors.allowed-headers=*
spring.web.cors.allow-credentials=true

# ---- OpenAPI / Swagger ----
springdoc.api-docs.enabled=true
springdoc.swagger-ui.enabled=true
# springdoc.api-docs.path=/v3/api-docs
# springdoc.swagger-ui.path=/swagger-ui.html
